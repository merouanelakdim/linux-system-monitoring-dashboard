Sfrom flask import Flask, jsonify
import psutil
import os
from flask_cors import CORS


app = Flask(__name__)
CORS(app)

def get_cpu_temp():
    try:
        with open("/sys/class/thermal/thermal_zone0/temp", "r") as f:
            temp = int(f.read()) / 1000.0
            return temp
    except:
        return None

@app.get("/api/cpu")
def cpu_usage():
    return jsonify({"cpu_percent": psutil.cpu_percent(interval=1)})

@app.get("/api/ram")
def ram_usage():
    ram = psutil.virtual_memory()
    return jsonify({
        "total": ram.total,
        "used": ram.used,
        "percent": ram.percent
    })

@app.get("/api/temp")
def temperature():
    return jsonify({"temperature_c": get_cpu_temp()})

@app.get("/")
def home():
    return "Dashboard API Running!"

if __name__ == "__main__":
    app.run(host="0.0.0.0", port=8001)
